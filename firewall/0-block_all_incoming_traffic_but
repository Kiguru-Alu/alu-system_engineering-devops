#!/usr/bin/env bash
# 0-block_all_incoming_traffic_but
# Mandatory: Block all incoming traffic except TCP ports 22, 80, 443

# 1. Update package list and install ufw if not installed
sudo apt update
sudo apt install -y ufw

# 2. Reset UFW to clear existing rules
sudo ufw --force reset

# 3. Set default policies
# Deny all incoming traffic (DROP) and allow all outgoing
sudo ufw default deny incoming
sudo ufw default allow outgoing

# 4. Enable logging (helps with 'filtered' status)
sudo ufw logging on

# 5. Allow specific ports
sudo ufw allow 22/tcp   # SSH
sudo ufw allow 80/tcp   # HTTP
sudo ufw allow 443/tcp  # HTTPS SSL

# 6. Enable UFW (force yes to avoid interactive prompt)
sudo ufw --force enable

# 7. Verify status and rules
sudo ufw status verbose
